{"ast":null,"code":"var _s = $RefreshSig$();\n// based on the tutorial from https://usehooks.com/useAuth/\n\nimport { createContext, useState } from \"react\";\n// a bug with this hook prevented me from using it ðŸ˜¢\n// import { useLocalStorage } from \"@mantine/hooks\";\nimport { useNavigate } from \"react-router-dom\";\nlet AuthContext = /*#__PURE__*/createContext();\nexport { AuthContext as default };\n\n// Provider hook that creates auth object and handles state\nexport function useProvideAuth() {\n  _s();\n  const navigate = useNavigate();\n  const [loggedIn, setLoggedIn] = useState(window.localStorage.getItem(\"loggedIn\") === \"true\");\n  async function login(values, form) {\n    await fetch(\"https://tpeo-todo.herokuapp.com/auth/login\", {\n      method: \"POST\",\n      // *GET, POST, PUT, DELETE, etc.\n      mode: \"cors\",\n      // no-cors, *cors, same-origin\n      cache: \"no-cache\",\n      // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: \"same-origin\",\n      // include, *same-origin, omit\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      redirect: \"follow\",\n      // manual, *follow, error\n      referrerPolicy: \"no-referrer\",\n      // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n      body: JSON.stringify({\n        email: values.email,\n        password: values.password\n      }) // body data type must match \"Content-Type\" header\n    }).then(data => {\n      if (data.status === 200) {\n        const json = data.json();\n        return json;\n      } else {\n        throw Error(\"Invalid\");\n      }\n    }).then(json => {\n      setLoggedIn(true);\n      window.localStorage.setItem(\"loggedIn\", true);\n      window.localStorage.setItem(\"username\", json.username);\n      window.localStorage.setItem(\"token\", json.token); // Should be sent upon subsequent requests\n      navigate(\"../\");\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n  function logout() {\n    window.localStorage.clear();\n    setLoggedIn(false);\n  }\n  return {\n    loggedIn,\n    login,\n    logout\n  };\n}\n_s(useProvideAuth, \"SlRX0lEvrTmAGMe6m9+3zapDIzY=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["createContext","useState","useNavigate","AuthContext","default","useProvideAuth","navigate","loggedIn","setLoggedIn","window","localStorage","getItem","login","values","form","fetch","method","mode","cache","credentials","headers","redirect","referrerPolicy","body","JSON","stringify","email","password","then","data","status","json","Error","setItem","username","token","catch","err","console","log","logout","clear"],"sources":["/Users/aarushichitagi/Downloads/new-tpeo/full-stack-learning-repo-2022/Week_6/homework/frontend/src/contexts/AuthContext.js"],"sourcesContent":["// based on the tutorial from https://usehooks.com/useAuth/\n\nimport { createContext, useState } from \"react\";\n// a bug with this hook prevented me from using it ðŸ˜¢\n// import { useLocalStorage } from \"@mantine/hooks\";\nimport { useNavigate } from \"react-router-dom\";\n\nlet AuthContext = createContext();\nexport { AuthContext as default };\n\n// Provider hook that creates auth object and handles state\nexport function useProvideAuth() {\n  const navigate = useNavigate();\n  const [loggedIn, setLoggedIn] = useState(\n    window.localStorage.getItem(\"loggedIn\") === \"true\"\n  );\n\n  async function login(values, form) {\n    await fetch(\"https://tpeo-todo.herokuapp.com/auth/login\", {\n      method: \"POST\", // *GET, POST, PUT, DELETE, etc.\n      mode: \"cors\", // no-cors, *cors, same-origin\n      cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: \"same-origin\", // include, *same-origin, omit\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      redirect: \"follow\", // manual, *follow, error\n      referrerPolicy: \"no-referrer\", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n      body: JSON.stringify({ email: values.email, password: values.password }) // body data type must match \"Content-Type\" header\n    })\n      .then((data) => {\n        if (data.status === 200) {\n          const json = data.json();\n          return json;\n        } else {\n          throw Error(\"Invalid\");\n        }\n      })\n      .then((json) => {\n        setLoggedIn(true);\n        window.localStorage.setItem(\"loggedIn\", true);\n        window.localStorage.setItem(\"username\", json.username);\n        window.localStorage.setItem(\"token\", json.token); // Should be sent upon subsequent requests\n        navigate(\"../\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function logout() {\n    window.localStorage.clear();\n    setLoggedIn(false);\n  }\n\n  return {\n    loggedIn,\n    login,\n    logout\n  };\n}\n"],"mappings":";AAAA;;AAEA,SAASA,aAAa,EAAEC,QAAQ,QAAQ,OAAO;AAC/C;AACA;AACA,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,IAAIC,WAAW,gBAAGH,aAAa,EAAE;AACjC,SAASG,WAAW,IAAIC,OAAO;;AAE/B;AACA,OAAO,SAASC,cAAc,GAAG;EAAA;EAC/B,MAAMC,QAAQ,GAAGJ,WAAW,EAAE;EAC9B,MAAM,CAACK,QAAQ,EAAEC,WAAW,CAAC,GAAGP,QAAQ,CACtCQ,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,KAAK,MAAM,CACnD;EAED,eAAeC,KAAK,CAACC,MAAM,EAAEC,IAAI,EAAE;IACjC,MAAMC,KAAK,CAAC,4CAA4C,EAAE;MACxDC,MAAM,EAAE,MAAM;MAAE;MAChBC,IAAI,EAAE,MAAM;MAAE;MACdC,KAAK,EAAE,UAAU;MAAE;MACnBC,WAAW,EAAE,aAAa;MAAE;MAC5BC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,QAAQ,EAAE,QAAQ;MAAE;MACpBC,cAAc,EAAE,aAAa;MAAE;MAC/BC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEC,KAAK,EAAEb,MAAM,CAACa,KAAK;QAAEC,QAAQ,EAAEd,MAAM,CAACc;MAAS,CAAC,CAAC,CAAC;IAC3E,CAAC,CAAC,CACCC,IAAI,CAAEC,IAAI,IAAK;MACd,IAAIA,IAAI,CAACC,MAAM,KAAK,GAAG,EAAE;QACvB,MAAMC,IAAI,GAAGF,IAAI,CAACE,IAAI,EAAE;QACxB,OAAOA,IAAI;MACb,CAAC,MAAM;QACL,MAAMC,KAAK,CAAC,SAAS,CAAC;MACxB;IACF,CAAC,CAAC,CACDJ,IAAI,CAAEG,IAAI,IAAK;MACdvB,WAAW,CAAC,IAAI,CAAC;MACjBC,MAAM,CAACC,YAAY,CAACuB,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC;MAC7CxB,MAAM,CAACC,YAAY,CAACuB,OAAO,CAAC,UAAU,EAAEF,IAAI,CAACG,QAAQ,CAAC;MACtDzB,MAAM,CAACC,YAAY,CAACuB,OAAO,CAAC,OAAO,EAAEF,IAAI,CAACI,KAAK,CAAC,CAAC,CAAC;MAClD7B,QAAQ,CAAC,KAAK,CAAC;IACjB,CAAC,CAAC,CACD8B,KAAK,CAAEC,GAAG,IAAK;MACdC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;IAClB,CAAC,CAAC;EACN;EAEA,SAASG,MAAM,GAAG;IAChB/B,MAAM,CAACC,YAAY,CAAC+B,KAAK,EAAE;IAC3BjC,WAAW,CAAC,KAAK,CAAC;EACpB;EAEA,OAAO;IACLD,QAAQ;IACRK,KAAK;IACL4B;EACF,CAAC;AACH;AAAC,GAjDenC,cAAc;EAAA,QACXH,WAAW;AAAA"},"metadata":{},"sourceType":"module"}